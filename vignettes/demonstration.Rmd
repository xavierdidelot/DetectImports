---
title: "Demonstration of the Bayesian inference of imports"
author: "Xavier Didelot"
date: '`r Sys.Date()`'
output:
  pdf_document: default
vignette: >
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteIndexEntry{Demonstration of the Bayesian inference of imports}
  %\usepackage[utf8]{inputenc}
---

In this vignette we demonstrate the Bayesian inference of imports.

# Initialisation

```{r}
library(DetectImports)
library(ape)
set.seed(0)
```

# Simulation with a single import

Let's consider that the local population started in 2020 and a single import occurred in 2020.5.
1000 genomes were sampled between 2020 and 2021.

```{r}
tree=simImports(localPopStart=2020,importDates=c(2020.5),
                samplingStartDate=2020,samplingEndDate=2021,samplingNumber=1000)
plot(tree,show.tip.label = F)
axisPhylo(backward = F)
```

Let's detect the imports:

```{r}
res=detectImports(tree,verbose=F)
plot(res)
```


# Simulation with two imports

Let's consider that the local population started in 2020 and two imports occurred in 2020.33 and 2020.66.
1000 genomes were sampled between 2020 and 2021.

```{r}
set.seed(0)
tree=simImports(localPopStart=2020,importDates=c(2020.33,2020.66),
                samplingStartDate=2020,samplingEndDate=2021,samplingNumber=1000)
plot(tree,show.tip.label = F)
axisPhylo(backward = F)
```

Let's detect the imports:

```{r}
res=detectImports(tree)
plot(res)
```


