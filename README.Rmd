---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, echo = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/"
)
set.seed(0)
```

# Introduction

`DetectImports` is a R package aimed at distinguishing imported cases from locally acquired cases within a geographically limited genomic sample of an infectious disease. The input is a dated phylogeny of local genomes only, as can be build using `BEAST`, `treedater` or `BactDating`. The main output is an estimated probability of importation for each case in the dated phylogeny.

## Dependencies

`DetectImports` depends on [Stan](https://mc-stan.org/) through CmdStan. Although [other options might exist](https://mc-stan.org/docs/cmdstan-guide/cmdstan-installation.html), for instance using Conda, the simplest option is to install CmdStan via the R package [CmdStanR](https://mc-stan.org/cmdstanr/). You can do so with the commands
```{r}
install.packages("cmdstanr", repos = c("https://mc-stan.org/r-packages/", getOption("repos")))
library(cmdstanr)
install_cmdstan()
```
The last command will download and compile all the missing dependencies.

## Installation

You can install `DetectImports` directly from github with the command:

```{r gh-installation, eval = FALSE}
devtools::install_github("xavierdidelot/DetectImports")
```

The package can then be loaded using:
```{r}
library(DetectImports)
```

## Quick example

First we generate a random tree with 100 leaves:

```{r message=F,warning=F,results='hide'}
library(ape)
library(DetectImports)
set.seed(0)
tree=rtree(100)
plot(tree,show.tip.label=F)
axisPhylo(1,backward = F)
```

Let us detect the imports in this tree:

```{r message=F,warning=F,results='hide'}
r=detectImports(tree)
plot(r)
```

Here we see that no import was detected. For more advanced examples of use, see the vignettes.
